<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagination Test Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            background-color: #333;
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .image-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .image-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .image-card .title {
            padding: 10px;
            font-size: 14px;
            color: #333;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
        }
        
        .pagination a,
        .pagination span {
            padding: 10px 15px;
            background: white;
            border: 1px solid #ddd;
            text-decoration: none;
            color: #333;
            border-radius: 4px;
        }
        
        .pagination .current,
        .pagination .active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .pagination a:hover {
            background: #f0f0f0;
        }
        
        .test-results {
            background: white;
            padding: 20px;
            margin-top: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-results h2 {
            margin-top: 0;
        }
        
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .test-result.pass {
            background: #d4edda;
            color: #155724;
        }
        
        .test-result.fail {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Pagination Test Page - Page 1</h1>
        <p>Test the StepThree Gallery Scraper pagination functionality</p>
    </div>
    
    <div class="gallery">
        <!-- Sample images -->
        <div class="image-card">
            <img src="https://via.placeholder.com/200x200/FF6B6B/FFFFFF?text=Image+1" alt="Image 1">
            <div class="title">Image 1</div>
        </div>
        <div class="image-card">
            <img src="https://via.placeholder.com/200x200/4ECDC4/FFFFFF?text=Image+2" alt="Image 2">
            <div class="title">Image 2</div>
        </div>
        <div class="image-card">
            <img src="https://via.placeholder.com/200x200/45B7D1/FFFFFF?text=Image+3" alt="Image 3">
            <div class="title">Image 3</div>
        </div>
        <div class="image-card">
            <img src="https://via.placeholder.com/200x200/FFA07A/FFFFFF?text=Image+4" alt="Image 4">
            <div class="title">Image 4</div>
        </div>
        <div class="image-card">
            <img src="https://via.placeholder.com/200x200/98D8C8/FFFFFF?text=Image+5" alt="Image 5">
            <div class="title">Image 5</div>
        </div>
        <div class="image-card">
            <img src="https://via.placeholder.com/200x200/F7DC6F/FFFFFF?text=Image+6" alt="Image 6">
            <div class="title">Image 6</div>
        </div>
    </div>
    
    <!-- Standard numbered pagination -->
    <div class="pagination">
        <a href="test-pagination.html?page=1" class="current">1</a>
        <a href="test-pagination.html?page=2" rel="next">2</a>
        <a href="test-pagination.html?page=3">3</a>
        <a href="test-pagination.html?page=2" class="next">Next →</a>
    </div>
    
    <div class="test-results">
        <h2>Pagination Detector Test Results</h2>
        <div id="test-output"></div>
        <button onclick="runTests()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px;">
            Run Tests
        </button>
    </div>
    
    <script>
        function runTests() {
            const output = document.getElementById('test-output');
            output.innerHTML = '<p>Running tests...</p>';
            
            const results = [];
            
            // Test 1: Check if PaginationDetector is available
            const test1 = {
                name: 'PaginationDetector is available in window scope',
                pass: typeof window.PaginationDetector !== 'undefined',
                message: typeof window.PaginationDetector !== 'undefined' 
                    ? '✅ window.PaginationDetector is defined'
                    : '❌ window.PaginationDetector is NOT defined'
            };
            results.push(test1);
            
            // Test 2: Check if PaginationDetector is available in __ST namespace
            const test2 = {
                name: 'PaginationDetector is available in __ST namespace',
                pass: window.__ST && typeof window.__ST.PaginationDetector !== 'undefined',
                message: (window.__ST && typeof window.__ST.PaginationDetector !== 'undefined')
                    ? '✅ window.__ST.PaginationDetector is defined'
                    : '❌ window.__ST.PaginationDetector is NOT defined'
            };
            results.push(test2);
            
            // Test 3: Try to instantiate PaginationDetector
            let detector = null;
            let test3;
            try {
                if (window.PaginationDetector) {
                    detector = new window.PaginationDetector();
                    test3 = {
                        name: 'Can instantiate PaginationDetector',
                        pass: true,
                        message: '✅ Successfully created PaginationDetector instance'
                    };
                } else {
                    test3 = {
                        name: 'Can instantiate PaginationDetector',
                        pass: false,
                        message: '❌ window.PaginationDetector is not available'
                    };
                }
            } catch (error) {
                test3 = {
                    name: 'Can instantiate PaginationDetector',
                    pass: false,
                    message: `❌ Error instantiating: ${error.message}`
                };
            }
            results.push(test3);
            
            // Test 4: Test findNextPage method
            if (detector) {
                try {
                    const nextPageInfo = detector.findNextPage();
                    const test4 = {
                        name: 'findNextPage() can detect pagination',
                        pass: nextPageInfo !== null,
                        message: nextPageInfo 
                            ? `✅ Found next page: ${nextPageInfo.url} (type: ${nextPageInfo.type}, confidence: ${nextPageInfo.confidence})`
                            : '❌ Could not find next page on this test page'
                    };
                    results.push(test4);
                } catch (error) {
                    results.push({
                        name: 'findNextPage() can detect pagination',
                        pass: false,
                        message: `❌ Error calling findNextPage: ${error.message}`
                    });
                }
                
                // Test 5: Test getPaginationInfo method
                try {
                    const paginationInfo = detector.getPaginationInfo();
                    const test5 = {
                        name: 'getPaginationInfo() returns page info',
                        pass: paginationInfo && typeof paginationInfo === 'object',
                        message: paginationInfo 
                            ? `✅ Pagination info: Current page ${paginationInfo.currentPage}, Total pages: ${paginationInfo.totalPages}, Has next: ${paginationInfo.hasNext}`
                            : '❌ Could not get pagination info'
                    };
                    results.push(test5);
                } catch (error) {
                    results.push({
                        name: 'getPaginationInfo() returns page info',
                        pass: false,
                        message: `❌ Error calling getPaginationInfo: ${error.message}`
                    });
                }
            }
            
            // Display results
            let html = '';
            let allPassed = true;
            results.forEach(result => {
                html += `<div class="test-result ${result.pass ? 'pass' : 'fail'}">
                    <strong>${result.name}</strong><br>
                    ${result.message}
                </div>`;
                if (!result.pass) allPassed = false;
            });
            
            html = `<h3>${allPassed ? '✅ All tests passed!' : '❌ Some tests failed'}</h3>` + html;
            output.innerHTML = html;
        }
        
        // Auto-run tests when page loads (with a small delay to ensure content script is loaded)
        window.addEventListener('load', () => {
            setTimeout(runTests, 1000);
        });
    </script>
</body>
</html>
